import csv
import pandas as pd

u13 = [[272, 147, 121, 766, 493, 338, 305, 178, 2, 168, 860, 440, 764, 437, 353, 861, 40, 443, 269, 154, 261, 866, 294, 659, 420, 812, 651, 449, 431, 379, 51, 96, 216, 462, 200, 884, 321, 292, 849, 578, 603, 117, 914, 177, 183, 241, 850, 299, 895, 670, 775, 789, 561, 572, 439, 50, 835, 197, 507, 239, 511, 158, 722, 127, 619, 235, 438, 549],
       [98, 186, 308, 331, 289, 567, 548, 508, 212, 540, 782, 302, 452, 303, 759, 243, 457, 857, 124, 71, 345, 317, 652, 173, 402, 564, 349, 828, 589, 258, 23, 838, 327, 313, 663, 855, 554, 401, 92, 339, 13, 311, 433, 565, 740, 91, 5, 471, 657, 656, 655, 306, 762, 199, 160, 758, 675, 228, 751, 817, 862, 288, 275, 145, 174, 819, 209, 590],
       [360, 344, 823, 354, 97, 877, 94, 29, 64, 614, 788, 318, 161, 190, 384, 505, 539, 752, 301, 363, 665, 617, 281, 735, 268, 201, 783, 787, 604, 678, 435, 475, 478, 672, 83, 350, 316, 553, 95, 709, 790, 551, 661, 833, 733, 355, 332, 128, 179, 865, 650, 896, 576, 67, 473, 37, 58, 748, 111, 558, 569, 777, 497, 322, 175, 132, 863, 362, 825],
       [198, 498, 809, 72, 807, 488, 781, 685, 915, 908, 830, 913, 312, 88, 208, 341, 502, 137, 776, 48, 467, 720, 802, 597, 100, 546, 694, 196, 847, 520, 805, 519, 217, 27, 238, 481, 878, 842, 234, 329, 872, 463, 739, 342, 796, 347, 909, 419, 585, 170, 801, 518, 7, 494, 900, 639, 194, 286, 204, 17, 636, 411, 684, 573, 410, 87, 510, 346, 881, 348, 771, 806, 227, 491, 506, 53, 911, 326, 853, 474, 916, 767, 187, 445, 176],
       [215, 229, 418, 195, 59, 320, 570, 314, 273, 300, 509, 625, 90, 831, 409, 387, 416, 612, 907, 869, 73, 854, 887, 153, 906, 501, 436, 885, 472, 276, 414, 377, 673, 852, 821, 839, 524, 757, 538, 804, 770, 523, 606, 829, 679, 646, 191, 843, 110, 1, 871, 484, 851, 791, 845, 427, 394, 430, 769, 403, 86, 224, 39, 815, 231, 444, 164, 82, 485, 897, 586, 602, 323, 531, 902, 662, 903, 310, 262, 691, 49, 749, 779, 504, 837],
       [526, 56, 901, 181, 396, 14, 144, 844, 226, 42, 45, 859, 319, 263, 794, 898, 25, 786, 517, 232, 784, 118, 615, 890, 808, 230, 716, 447, 271, 588, 423, 772, 185, 912, 333, 450, 516, 11, 89, 889, 559, 800, 785, 773, 417, 880, 613, 527, 79, 68, 222, 795, 12, 792, 879, 688, 754, 747, 867, 737, 492, 736, 33, 761, 891, 279, 668, 635, 223, 406, 398, 687, 307, 382, 750, 274, 38, 370, 746, 393, 184, 826, 799, 143, 242, 60]]

u276 = [[54, 568, 157, 246, 34, 301, 76, 66, 786, 456, 228, 63, 164, 69, 1228, 449, 404, 302, 831, 806, 125, 665, 559, 118, 977, 697, 549, 396, 410, 750, 62, 692, 959, 974, 144, 634, 44, 771, 53, 123, 768, 82, 475, 552, 355, 72, 1482, 881, 871, 508, 397, 1036, 39, 245, 95, 685],
        [322, 40, 1157, 550, 384, 401, 1135, 780, 22, 290, 229, 854, 779, 1110, 121, 1044, 420, 168, 427, 693, 156, 742, 333, 204, 423, 562, 153, 825, 1245, 264, 354, 21, 99, 298, 461, 289, 399, 627, 31, 393, 9, 1098, 328, 233, 174, 122, 928, 624, 1016, 443, 385, 65, 179, 425, 150, 710],
        [1091, 142, 324, 38, 789, 347, 250, 563, 719, 496, 139, 265, 276, 238, 751, 340, 403, 203, 471, 547, 288, 930, 74, 101, 1220, 734, 451, 951, 653, 942, 1301, 192, 128, 603, 271, 1194, 241, 572, 739, 765, 1118, 679, 455, 546, 346, 28, 185, 173, 25, 518, 257, 540, 554, 728, 269, 332],
        [2, 70, 294, 1081, 773, 583, 1416, 429, 58, 770, 463, 684, 249, 272, 117, 1253, 1073, 941, 141, 418, 672, 315, 14, 1471, 127, 169, 91, 5, 206, 186, 774, 569, 124, 652, 258, 50, 1031, 84, 931, 691, 120, 1407, 800, 915, 391, 1141, 189, 655, 658, 458, 367, 735, 51, 184, 375, 235, 582, 943, 1208, 678, 405, 1000, 148, 575, 1213, 407, 334, 109, 975, 200],
        [922, 188, 474, 273, 226, 180, 1218, 1131, 56, 1314, 969, 1210, 747, 81, 77, 1013, 1239, 432, 577, 450, 232, 1089, 743, 1180, 41, 171, 408, 386, 196, 551, 409, 803, 628, 98, 591, 1083, 1047, 402, 823, 797, 222, 158, 802, 715, 358, 388, 356, 1028, 647, 274, 453, 183, 1267, 794, 709, 1481, 1, 890, 225, 254, 431, 820, 260, 1145, 472, 12, 844, 96, 187, 237],
        [796, 57, 181, 357, 939, 43, 843, 104, 318, 207, 748, 147, 230, 746, 737, 231, 282, 879, 366, 669, 4, 1240, 209, 145, 210, 470, 268, 566, 686, 135, 1035, 8, 581, 198, 380, 1079, 108, 720, 79, 343, 558, 17, 916, 88, 1042, 433, 159, 239, 1056, 252, 281, 411, 759, 160, 42, 67, 219, 1074, 202, 387, 3, 993, 7, 531, 217, 55, 428, 248, 919, 89]]

df = pd.read_csv('dataset//training_data.csv')
with open('dataset//training_data.csv', mode='a', newline='') as a:
    c_writer = csv.writer(a, delimiter=',', quotechar='"', quoting=csv.QUOTE_MINIMAL)

    counter = 0
    for i in u276:
        uid = 276*100+counter
        for j in i:
            a = df.query(f'user==276 and item=={j}')
            b = a['rating'].values[0]
            c_writer.writerow([j, uid, b])

        counter -= -1

